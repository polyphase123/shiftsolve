<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>IIEE 50th Convention</title>
    
    <!-- React & ReactDOM -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    
    <!-- Babel for JSX -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- FontAwesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700;900&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">

    <style>
        body {
            font-family: 'Roboto', sans-serif;
            background-color: #f3f4f6;
            -webkit-tap-highlight-color: transparent;
            overscroll-behavior-y: none;
        }
        
        .no-scrollbar::-webkit-scrollbar { display: none; }
        .no-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }

        html { scroll-behavior: smooth; }

        .app-container {
            max-width: 480px; 
            margin: 0 auto;
            background-color: #ffffff;
            min-height: 100vh;
            box-shadow: 0 0 20px rgba(0,0,0,0.1);
            position: relative;
            padding-bottom: 90px;
        }

        /* Card Animation */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .animate-fade-in {
            animation: fadeIn 0.3s ease-out forwards;
        }

        /* Specific styles for the reference look */
        .top-dev-bar { background-color: #1a237e; color: #fff; font-size: 0.65rem; }
        .main-header { background-color: #283593; }
        .sim-time-bar { background-color: #3949ab; }
        .tab-active { border-bottom: 3px solid #fbc02d; color: #fbc02d; font-weight: 700; }
        .tab-inactive { color: #c5cae9; }
        .event-card { border-left: 6px solid #42a5f5; }
        .bottom-nav-shadow { box-shadow: 0 -4px 20px rgba(0,0,0,0.05); }

        /* Modal Backdrop */
        .modal-backdrop {
            background-color: rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(2px);
        }

        /* --- MARIO COIN ANIMATIONS --- */
        .mario-font { font-family: 'Press Start 2P', cursive; }
        
        @keyframes blockBump {
            0% { transform: translateY(0); }
            50% { transform: translateY(-15px); }
            100% { transform: translateY(0); }
        }
        
        @keyframes coinPop {
            0% { transform: translateY(0) rotateY(0); opacity: 0; }
            10% { opacity: 1; }
            50% { transform: translateY(-120px) rotateY(360deg) scale(1.2); }
            80% { opacity: 1; }
            100% { transform: translateY(-140px) rotateY(720deg) scale(1); opacity: 0; }
        }

        @keyframes scoreFloat {
            0% { opacity: 0; transform: translateY(-80px); }
            50% { opacity: 1; transform: translateY(-100px); }
            100% { opacity: 0; transform: translateY(-120px); }
        }

        /* Updated animations to trigger on class add without delay */
        .anim-block { animation: blockBump 0.2s ease-out; }
        .anim-coin { animation: coinPop 0.6s ease-out forwards; }
        .anim-score { animation: scoreFloat 0.8s ease-out 0.2s forwards; }

        .pixel-corners {
            image-rendering: pixelated;
            box-shadow: 
                -4px 0 0 0 #000,
                4px 0 0 0 #000,
                0 -4px 0 0 #000,
                0 4px 0 0 #000;
        }

        /* Calendar Styles */
        .calendar-grid {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 4px;
        }
        .calendar-day {
            aspect-ratio: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            border-radius: 8px;
            font-size: 0.9rem;
            position: relative;
        }
        .calendar-dot {
            width: 4px;
            height: 4px;
            background-color: #3b82f6;
            border-radius: 50%;
            margin-top: 2px;
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useMemo, useRef } = React;

        // --- DATA ---
        const createDate = (day, hour, minute) => new Date(2025, 10, day, hour, minute);

        const scheduleData = [
            // Nov 24 (Monday)
            { id: 101, dateStr: '2025-11-24', day: 24, startH: 8, startM: 0, endH: 17, endM: 0, timeDisplay: '8:00 AM - 5:00 PM', title: "Students' Activities", venue: 'Function Rooms 1-2', type: 'student', dayName: 'Mon' },
            { id: 102, dateStr: '2025-11-24', day: 24, startH: 8, startM: 0, endH: 17, endM: 0, timeDisplay: '8:00 AM - 5:00 PM', title: 'RME Skills Olympics', venue: 'Function Room 3', type: 'competition', dayName: 'Mon' },
            { id: 103, dateStr: '2025-11-24', day: 24, startH: 8, startM: 0, endH: 17, endM: 0, timeDisplay: '8:00 AM - 5:00 PM', title: 'Standards Committee', venue: 'Meeting Rooms 7 & 8', type: 'meeting', dayName: 'Mon' },
            { id: 104, dateStr: '2025-11-24', day: 24, startH: 8, startM: 0, endH: 17, endM: 0, timeDisplay: '8:00 AM - 5:00 PM', title: 'Releasing of Kits', venue: 'Meeting Rooms 4, 5 & 6', type: 'admin', dayName: 'Mon' },
            { id: 105, dateStr: '2025-11-24', day: 24, startH: 8, startM: 0, endH: 17, endM: 0, timeDisplay: '8:00 AM - 5:00 PM', title: 'Basketball', venue: 'Koten Gym, Pasay City', type: 'sports', dayName: 'Mon' },

            // Nov 25 (Tuesday)
            { id: 201, dateStr: '2025-11-25', day: 25, startH: 8, startM: 0, endH: 17, endM: 0, timeDisplay: '8:00 AM - 5:00 PM', title: "Students' Activities", venue: 'Function Rooms 1-2', type: 'student', dayName: 'Tue' },
            { id: 202, dateStr: '2025-11-25', day: 25, startH: 8, startM: 0, endH: 17, endM: 0, timeDisplay: '8:00 AM - 5:00 PM', title: 'Mega Webinar', venue: 'Function Room 3', type: 'technical', dayName: 'Tue' },
            { id: 203, dateStr: '2025-11-25', day: 25, startH: 8, startM: 0, endH: 17, endM: 0, timeDisplay: '8:00 AM - 5:00 PM', title: 'PEC Activities', venue: 'Meeting Rooms 7 & 8', type: 'technical', dayName: 'Tue' },
            { id: 204, dateStr: '2025-11-25', day: 25, startH: 8, startM: 0, endH: 17, endM: 0, timeDisplay: '8:00 AM - 5:00 PM', title: 'Technical Sessions', venue: 'Meeting Rooms 4, 5 & 6', type: 'technical', dayName: 'Tue' },

            // Nov 26 (Wednesday)
            { id: 301, dateStr: '2025-11-26', day: 26, startH: 8, startM: 0, endH: 17, endM: 0, timeDisplay: '8:00 AM - 5:00 PM', title: "Students' Activities", venue: 'Function Rooms 1-2', type: 'student', dayName: 'Wed' },
            { id: 302, dateStr: '2025-11-26', day: 26, startH: 8, startM: 0, endH: 17, endM: 0, timeDisplay: '8:00 AM - 5:00 PM', title: 'Mega Webinar', venue: 'Function Room 3', type: 'technical', dayName: 'Wed' },
            { id: 307, dateStr: '2025-11-26', day: 26, startH: 8, startM: 0, endH: 18, endM: 0, timeDisplay: '8:00 AM - 6:00 PM', title: 'IIEE WEN Forum', venue: 'Exhibit Area', type: 'forum', dayName: 'Wed' },

            // Nov 27 (Thursday)
            { id: 401, dateStr: '2025-11-27', day: 27, startH: 8, startM: 0, endH: 17, endM: 0, timeDisplay: '8:00 AM - 5:00 PM', title: 'RME Forum', venue: 'Meeting Room 7-8', type: 'forum', dayName: 'Thu' },
            { id: 402, dateStr: '2025-11-27', day: 27, startH: 8, startM: 0, endH: 17, endM: 0, timeDisplay: '8:00 AM - 5:00 PM', title: 'Safety Conference', venue: 'Meeting Room 4, 5 & 6', type: 'technical', dayName: 'Thu' },
            { id: 404, dateStr: '2025-11-27', day: 27, startH: 8, startM: 30, endH: 11, endM: 30, timeDisplay: '8:30 AM - 11:30 AM', title: 'Opening Ceremonies', venue: 'Function Rooms 1-4', type: 'plenary', dayName: 'Thu' },
            { id: 405, dateStr: '2025-11-27', day: 27, startH: 13, startM: 30, endH: 16, endM: 30, timeDisplay: '1:30 PM - 4:30 PM', title: 'Simultaneous Tech Sessions', venue: 'Function Rooms 1-4', type: 'technical', dayName: 'Thu' },

            // Nov 28 (Friday)
            { id: 501, dateStr: '2025-11-28', day: 28, startH: 8, startM: 30, endH: 12, endM: 0, timeDisplay: '8:30 AM - 12:00 NN', title: 'Tech Session: Renewable Energy', venue: 'Function Room 1', type: 'technical', dayName: 'Fri' },
            { id: 502, dateStr: '2025-11-28', day: 28, startH: 8, startM: 30, endH: 12, endM: 0, timeDisplay: '8:30 AM - 12:00 NN', title: 'Tech Session: Grid Modernization', venue: 'Function Room 2', type: 'technical', dayName: 'Fri' },
            { id: 503, dateStr: '2025-11-28', day: 28, startH: 13, startM: 0, endH: 15, endM: 0, timeDisplay: '1:00 PM - 3:00 PM', title: 'Technical Sessions (PM)', venue: 'Function Rooms 1-3', type: 'technical', dayName: 'Fri' },
            { id: 504, dateStr: '2025-11-28', day: 28, startH: 15, startM: 0, endH: 18, endM: 0, timeDisplay: '3:00 PM - 6:00 PM', title: 'General Membership Meeting', venue: 'Function Rooms 1-3', type: 'plenary', dayName: 'Fri' },
            
            // Nov 29 (Saturday)
            { id: 601, dateStr: '2025-11-29', day: 29, startH: 8, startM: 30, endH: 12, endM: 0, timeDisplay: '8:30 AM - 12:00 NN', title: 'Career Mentoring', venue: 'Function Room 1', type: 'student', dayName: 'Sat' },
            { id: 604, dateStr: '2025-11-29', day: 29, startH: 16, startM: 30, endH: 20, endM: 0, timeDisplay: '4:30 PM - 8:00 PM', title: 'Closing Ceremonies', venue: 'Function Rooms 1-4', type: 'plenary', dayName: 'Sat' },
        ];

        const venueData = [
            {
                category: 'Hotels',
                items: [
                    { name: "Conrad Manila", dist: "0.2 km", desc: "Luxury 5-star linked to SMX.", map: "https://goo.gl/maps/ConradManila" },
                    { name: "Microtel by Wyndham", dist: "0.3 km", desc: "Convenient stay.", map: "https://goo.gl/maps/MicrotelMOA" },
                    { name: "Hotel 101 Manila", dist: "0.8 km", desc: "Business hotel.", map: "https://goo.gl/maps/Hotel101" }
                ]
            },
            {
                category: 'Food',
                items: [
                    { name: "SM Mall of Asia", dist: "0.5 km", desc: "Hundreds of options.", map: "https://goo.gl/maps/MOA" },
                    { name: "IKEA Restaurant", dist: "0.6 km", desc: "Affordable meals.", map: "https://goo.gl/maps/IKEA" },
                    { name: "Vikings Buffet", dist: "1.2 km", desc: "Luxury buffet.", map: "https://goo.gl/maps/Vikings" }
                ]
            }
        ];

        // --- COMPONENTS ---

        function SplashScreen({ onComplete }) {
            const [isAnimating, setIsAnimating] = useState(false);
            const [hasStarted, setHasStarted] = useState(false);

            const playCoinSound = () => {
                try {
                    const AudioContext = window.AudioContext || window.webkitAudioContext;
                    if (!AudioContext) return;
                    
                    const ctx = new AudioContext();
                    const osc = ctx.createOscillator();
                    const gain = ctx.createGain();

                    osc.connect(gain);
                    gain.connect(ctx.destination);

                    // Super Mario Coin Sound Structure: B5 (988Hz) -> E6 (1319Hz)
                    osc.type = 'square';
                    osc.frequency.setValueAtTime(988, ctx.currentTime);
                    osc.frequency.setValueAtTime(1319, ctx.currentTime + 0.08);

                    // Envelope
                    gain.gain.setValueAtTime(0.05, ctx.currentTime);
                    gain.gain.exponentialRampToValueAtTime(0.001, ctx.currentTime + 0.5);

                    osc.start(ctx.currentTime);
                    osc.stop(ctx.currentTime + 0.5);
                } catch (e) {
                    console.error("Audio play failed", e);
                }
            };

            const handleStart = () => {
                if (hasStarted) return;
                setHasStarted(true);
                setIsAnimating(true);
                playCoinSound();

                // Wait for animation then complete
                setTimeout(() => {
                    onComplete();
                }, 1500); 
            };

            return (
                <div 
                    onClick={handleStart}
                    className="fixed inset-0 z-[100] bg-blue-900 flex flex-col items-center justify-center overflow-hidden cursor-pointer"
                >
                    <div className="relative flex flex-col items-center justify-end h-64 w-full mb-8">
                        
                        {/* THE COIN */}
                        {isAnimating && (
                            <div className="absolute w-12 h-12 bg-yellow-400 rounded-full border-4 border-yellow-200 flex items-center justify-center shadow-lg anim-coin z-10">
                                <span className="mario-font text-yellow-700 font-bold text-xs">50</span>
                            </div>
                        )}
                        
                        {/* SCORE TEXT */}
                        {isAnimating && (
                            <div className="absolute mario-font text-white text-sm anim-score z-20">
                                50th
                            </div>
                        )}

                        {/* QUESTION BLOCK */}
                        <div className={`w-16 h-16 bg-yellow-500 rounded-lg border-b-4 border-r-4 border-yellow-700 relative z-0 flex items-center justify-center pixel-corners shadow-xl ${isAnimating ? 'anim-block' : 'animate-bounce'}`}>
                            <div className="absolute top-1 left-1 w-2 h-2 bg-yellow-200 rounded-full opacity-50"></div>
                            <span className="mario-font text-yellow-800 text-3xl font-bold">?</span>
                            <div className="absolute inset-0 border-2 border-yellow-600 opacity-20 rounded-lg"></div>
                        </div>

                    </div>
                    
                    <div className={`text-center transition-opacity duration-500 ${isAnimating ? 'opacity-0' : 'opacity-100'}`}>
                        <h1 className="text-white text-2xl font-bold mb-2">IIEE 50th</h1>
                        <p className="text-yellow-300 text-xs tracking-widest mario-font animate-pulse">TAP TO START</p>
                    </div>
                </div>
            );
        }

        function App() {
            const [isLoading, setIsLoading] = useState(true);
            const [view, setView] = useState('schedule');
            const [subTab, setSubTab] = useState('ALL');
            const [simTime, setSimTime] = useState(new Date(2025, 10, 28, 9, 0));
            const [searchQuery, setSearchQuery] = useState('');
            
            // Calendar State
            const [calSelectedDateStr, setCalSelectedDateStr] = useState('2025-11-24');

            const [myAgenda, setMyAgenda] = useState(() => {
                const saved = localStorage.getItem('myAgenda');
                return saved ? JSON.parse(saved) : [];
            });
            const [myNotes, setMyNotes] = useState(() => {
                const saved = localStorage.getItem('myNotes');
                return saved ? JSON.parse(saved) : {};
            });

            // Persist Agenda & Notes
            useEffect(() => { localStorage.setItem('myAgenda', JSON.stringify(myAgenda)); }, [myAgenda]);
            useEffect(() => { localStorage.setItem('myNotes', JSON.stringify(myNotes)); }, [myNotes]);

            // --- NOTE MODAL STATE ---
            const [showNoteModal, setShowNoteModal] = useState(false);
            const [activeNoteId, setActiveNoteId] = useState(null);
            const [tempNoteText, setTempNoteText] = useState('');
            const noteInputRef = useRef(null);

            const toggleAgenda = (id) => {
                if (myAgenda.includes(id)) {
                    setMyAgenda(myAgenda.filter(itemId => itemId !== id));
                } else {
                    setMyAgenda([...myAgenda, id]);
                }
            };

            // --- NOTE HANDLERS ---
            const openNoteModal = (e, eventId) => {
                e.stopPropagation();
                setActiveNoteId(eventId);
                setTempNoteText(myNotes[eventId] || '');
                setShowNoteModal(true);
                setTimeout(() => { if (noteInputRef.current) noteInputRef.current.focus(); }, 100);
            };

            const saveNote = () => {
                const trimmed = tempNoteText.trim();
                setMyNotes(prev => {
                    const next = { ...prev };
                    if (trimmed) next[activeNoteId] = trimmed;
                    else delete next[activeNoteId];
                    return next;
                });
                setShowNoteModal(false);
            };

            // --- TIME SIMULATION ---
            const adjustTime = (amount, unit) => {
                const newTime = new Date(simTime);
                if (unit === 'D') newTime.setDate(newTime.getDate() + amount);
                if (unit === 'H') newTime.setHours(newTime.getHours() + amount);
                setSimTime(newTime);
            };

            const formatSimTime = (date) => {
                const day = date.getDate();
                const hours = date.getHours();
                const minutes = date.getMinutes();
                const ampm = hours >= 12 ? 'PM' : 'AM';
                const formattedHours = hours % 12 || 12;
                const formattedMinutes = minutes < 10 ? '0' + minutes : minutes;
                const getOrdinal = (n) => {
                    const s = ["th", "st", "nd", "rd"];
                    const v = n % 100;
                    return n + (s[(v - 20) % 10] || s[v] || s[0]);
                };
                return `${formattedHours}:${formattedMinutes} ${ampm} (${getOrdinal(day)})`;
            };

            // --- FILTER LOGIC (Main Schedule) ---
            const filteredEvents = useMemo(() => {
                let events = scheduleData.filter(e => 
                    e.title.toLowerCase().includes(searchQuery.toLowerCase()) ||
                    e.venue.toLowerCase().includes(searchQuery.toLowerCase())
                );

                if (subTab === 'MY AGENDA') {
                    events = events.filter(e => myAgenda.includes(e.id));
                } else if (subTab === 'NOW') {
                    events = events.filter(e => {
                        const start = createDate(e.day, e.startH, e.startM);
                        const end = createDate(e.day, e.endH, e.endM);
                        return simTime >= start && simTime <= end;
                    });
                } else if (subTab === 'SOON') {
                    events = events.filter(e => {
                        const start = createDate(e.day, e.startH, e.startM);
                        const twoHoursLater = new Date(simTime.getTime() + (2 * 60 * 60 * 1000));
                        return start > simTime && start <= twoHoursLater;
                    });
                }
                
                events.sort((a,b) => {
                    if (a.day !== b.day) return a.day - b.day;
                    return a.startH - b.startH;
                });

                return events;
            }, [searchQuery, subTab, myAgenda, simTime]);

            const renderEventCard = (event) => {
                const hasNote = !!myNotes[event.id];
                return (
                    <div key={event.id} className="bg-white rounded-lg p-4 shadow-sm mb-3 event-card relative animate-fade-in">
                        <div className="pr-8">
                            <div className="text-blue-900 font-bold text-sm mb-1">
                                {event.timeDisplay}
                            </div>
                            <h3 className="text-lg font-bold text-gray-800 leading-tight mb-2">{event.title}</h3>
                            <div className="flex items-center text-gray-500 text-sm mb-1">
                                <i className="fas fa-map-marker-alt w-4 text-center mr-2 text-gray-400"></i>
                                {event.venue}
                            </div>
                            <div className="flex items-center text-gray-500 text-sm mb-3">
                                <i className="fas fa-calendar-day w-4 text-center mr-2 text-gray-400"></i>
                                {event.dayName}, Nov {event.day}
                            </div>
                            
                            {hasNote && (
                                <div onClick={(e) => openNoteModal(e, event.id)} className="mb-3 bg-yellow-50 border border-yellow-200 p-2 rounded text-sm text-gray-700 italic cursor-pointer hover:bg-yellow-100 transition">
                                    <i className="fas fa-sticky-note text-yellow-500 mr-2"></i>
                                    "{myNotes[event.id]}"
                                </div>
                            )}

                            <div className="flex gap-3">
                                <button onClick={(e) => openNoteModal(e, event.id)} className={`flex-1 py-2 rounded-lg text-sm font-semibold transition flex items-center justify-center ${hasNote ? 'bg-blue-100 text-blue-700 hover:bg-blue-200' : 'bg-gray-100 text-gray-600 hover:bg-gray-200'}`}>
                                    <i className={`${hasNote ? 'fas' : 'fas'} fa-pen-nib mr-2 text-xs`}></i> 
                                    {hasNote ? 'Edit Note' : 'Note'}
                                </button>
                                <button className="flex-1 bg-gray-100 text-gray-600 py-2 rounded-lg text-sm font-semibold hover:bg-gray-200 transition flex items-center justify-center">
                                    <i className="fas fa-bolt mr-2 text-xs text-yellow-600"></i> 3 CPD
                                </button>
                            </div>
                        </div>
                        <button onClick={() => toggleAgenda(event.id)} className="absolute top-4 right-4 p-2">
                            <i className={`${myAgenda.includes(event.id) ? 'fas text-yellow-400' : 'far text-gray-300'} fa-star text-xl`}></i>
                        </button>
                    </div>
                );
            };

            // --- CALENDAR RENDERER ---
            const CalendarContent = () => {
                // Calendar Setup for Nov 2025
                const year = 2025;
                const month = 10; // Nov
                const daysInMonth = 30;
                const firstDayIndex = 6; // Nov 1 2025 is Saturday

                const days = Array.from({ length: daysInMonth }, (_, i) => i + 1);
                const blanks = Array.from({ length: firstDayIndex }, (_, i) => i);
                
                // Events for the selected day in Calendar View
                const selectedDayEvents = scheduleData.filter(e => e.dateStr === calSelectedDateStr).sort((a,b) => a.startH - b.startH);

                // Helper to check if a specific day has events
                const hasEvents = (day) => {
                    const dStr = `2025-11-${day < 10 ? '0' + day : day}`;
                    return scheduleData.some(e => e.dateStr === dStr);
                };

                return (
                    <div className="animate-fade-in">
                        <div className="bg-white p-4 rounded-xl shadow-sm mb-4">
                            <div className="flex justify-between items-center mb-4">
                                <h2 className="font-bold text-xl text-blue-900">November 2025</h2>
                                <div className="text-gray-400 text-sm">
                                    <i className="fas fa-chevron-left mr-3"></i>
                                    <i className="fas fa-chevron-right"></i>
                                </div>
                            </div>

                            {/* Weekday Headers */}
                            <div className="grid grid-cols-7 mb-2 text-center text-xs font-bold text-gray-400 uppercase">
                                <div>Sun</div><div>Mon</div><div>Tue</div><div>Wed</div><div>Thu</div><div>Fri</div><div>Sat</div>
                            </div>

                            {/* Days Grid */}
                            <div className="calendar-grid">
                                {blanks.map((_, i) => <div key={`blank-${i}`} className="calendar-day"></div>)}
                                {days.map(day => {
                                    const dateStr = `2025-11-${day < 10 ? '0' + day : day}`;
                                    const isSelected = calSelectedDateStr === dateStr;
                                    const isToday = simTime.getDate() === day && simTime.getMonth() === 10;
                                    const eventDot = hasEvents(day);

                                    return (
                                        <div 
                                            key={day} 
                                            onClick={() => setCalSelectedDateStr(dateStr)}
                                            className={`calendar-day cursor-pointer transition-colors ${isSelected ? 'bg-yellow-400 text-blue-900 font-bold shadow-md' : 'hover:bg-gray-100 text-gray-700'} ${isToday && !isSelected ? 'border-2 border-blue-500' : ''}`}
                                        >
                                            <span>{day}</span>
                                            {eventDot && !isSelected && <div className="calendar-dot"></div>}
                                        </div>
                                    );
                                })}
                            </div>
                        </div>

                        {/* Selected Day Events List */}
                        <div className="mb-2 flex items-center justify-between px-1">
                            <h3 className="font-bold text-gray-700">Events for Nov {calSelectedDateStr.split('-')[2]}</h3>
                            <span className="text-xs bg-blue-100 text-blue-800 px-2 py-1 rounded-full">{selectedDayEvents.length} Events</span>
                        </div>

                        <div className="space-y-1">
                            {selectedDayEvents.length > 0 ? (
                                selectedDayEvents.map(renderEventCard)
                            ) : (
                                <div className="text-center py-10 text-gray-400 bg-white rounded-lg border border-dashed border-gray-300">
                                    <i className="far fa-calendar-minus text-4xl mb-2 text-gray-200"></i>
                                    <p>No events scheduled for this day.</p>
                                </div>
                            )}
                        </div>
                    </div>
                );
            };

            const MenuContent = () => (
                <div className="animate-fade-in space-y-4">
                    <div className="bg-white p-4 rounded-lg shadow-sm">
                        <h3 className="font-bold text-gray-800 mb-2">Venue Guide</h3>
                        {venueData.map((cat, i) => (
                            <div key={i} className="mb-4">
                                <h4 className="text-blue-800 font-bold text-sm uppercase tracking-wide mb-2">{cat.category}</h4>
                                <div className="space-y-2">
                                    {cat.items.map((item, idx) => (
                                        <a key={idx} href={item.map} target="_blank" className="block bg-gray-50 p-3 rounded hover:bg-blue-50 transition flex justify-between items-center">
                                            <div>
                                                <div className="font-medium text-gray-800">{item.name}</div>
                                                <div className="text-xs text-gray-500">{item.dist} • {item.desc}</div>
                                            </div>
                                            <i className="fas fa-chevron-right text-gray-300 text-xs"></i>
                                        </a>
                                    ))}
                                </div>
                            </div>
                        ))}
                    </div>
                    <div className="bg-white p-4 rounded-lg shadow-sm">
                        <h3 className="font-bold text-gray-800 mb-2">My Data</h3>
                        <div className="space-y-2">
                             <div className="flex justify-between p-2 bg-gray-50 rounded">
                                <span>Saved Notes</span>
                                <span className="font-bold text-blue-600">{Object.keys(myNotes).length}</span>
                             </div>
                             <div className="flex justify-between p-2 bg-gray-50 rounded">
                                <span>Agenda Items</span>
                                <span className="font-bold text-blue-600">{myAgenda.length}</span>
                             </div>
                        </div>
                    </div>
                </div>
            );

            // New View Component: All Notes
            const NotesListView = () => {
                const noteIds = Object.keys(myNotes);
                
                // Helper to get event details
                const getEvent = (id) => scheduleData.find(e => e.id.toString() === id.toString());

                return (
                    <div className="animate-fade-in space-y-4">
                         <h2 className="font-bold text-2xl text-blue-900 mb-2 px-1">My Notes</h2>
                         
                         {noteIds.length === 0 ? (
                            <div className="text-center py-16 text-gray-400 bg-white rounded-xl shadow-sm border border-dashed border-gray-200">
                                <div className="bg-yellow-100 w-16 h-16 rounded-full flex items-center justify-center mx-auto mb-4">
                                    <i className="fas fa-pen-nib text-2xl text-yellow-600"></i>
                                </div>
                                <h3 className="text-gray-600 font-bold mb-1">No Notes Yet</h3>
                                <p className="text-sm px-8">Tap the "Note" button on any scheduled event to write your takeaways here.</p>
                            </div>
                         ) : (
                             <div className="space-y-3">
                                {noteIds.map(id => {
                                    const event = getEvent(id);
                                    if (!event) return null;
                                    return (
                                        <div key={id} onClick={(e) => openNoteModal(e, parseInt(id))} className="bg-white p-4 rounded-xl shadow-sm border-l-4 border-yellow-400 cursor-pointer active:scale-[0.99] transition-transform">
                                            <div className="flex justify-between items-start mb-2">
                                                <h3 className="font-bold text-gray-800 text-sm">{event.title}</h3>
                                                <span className="text-xs text-gray-400 bg-gray-100 px-2 py-0.5 rounded-full">{event.dayName}</span>
                                            </div>
                                            <div className="text-gray-600 text-sm italic bg-yellow-50 p-3 rounded-lg border border-yellow-100">
                                                "{myNotes[id]}"
                                            </div>
                                            <div className="mt-2 text-right">
                                                <span className="text-xs font-bold text-blue-600">Tap to edit</span>
                                            </div>
                                        </div>
                                    );
                                })}
                             </div>
                         )}
                    </div>
                );
            };

            const ScheduleContent = () => (
                <div>
                    <div className="bg-white p-3 rounded-xl shadow-sm mb-4 border border-gray-100 flex items-center">
                         <i className="fas fa-search text-gray-300 mr-3 ml-1"></i>
                        <input type="text" placeholder="Search events..." className="w-full text-gray-700 focus:outline-none bg-transparent" value={searchQuery} onChange={(e) => setSearchQuery(e.target.value)} />
                    </div>
                    {filteredEvents.length === 0 && (
                        <div className="text-center py-16 text-gray-400">
                            <i className="far fa-calendar-times text-5xl mb-4 text-gray-200"></i>
                            <p>No events found.</p>
                            {subTab === 'NOW' && <p className="text-xs mt-2">Try adjusting the simulator time above.</p>}
                        </div>
                    )}
                    <div className="space-y-1">{filteredEvents.map(renderEventCard)}</div>
                </div>
            );

            // --- SPLASH SCREEN CHECK ---
            if (isLoading) {
                return <SplashScreen onComplete={() => setIsLoading(false)} />;
            }

            return (
                <div className="app-container flex flex-col">
                    {/* TOP BAR: DEV INFO */}
                    <div className="top-dev-bar py-1.5 px-4 flex flex-col justify-center items-center text-center leading-tight">
                        <div className="font-medium">Developed by Engr. Franz Xyrlo I. Tobias, PEE</div>
                        <div className="flex items-center mt-0.5"><i className="fas fa-phone-alt text-[0.6rem] mr-1"></i> 0936 923 8834</div>
                    </div>

                    <header className="main-header text-white px-4 pt-4 pb-0 sticky top-0 z-50">
                        <div className="flex justify-between items-center mb-4">
                            <div className="flex items-center gap-3">
                                <div className="w-12 h-12 rounded-full bg-yellow-400 flex items-center justify-center text-blue-900 font-bold border-2 border-white text-xl shadow-md">50</div>
                                <div>
                                    <h1 className="font-bold text-xl leading-none">IIEE Convention</h1>
                                    <p className="text-xs text-blue-200 mt-1">Nov 24-29, 2025 • SMX</p>
                                </div>
                            </div>
                            <button className="text-white text-2xl"><i className="fas fa-bars"></i></button>
                        </div>
                        <div className="sim-time-bar rounded-lg p-2 mb-4 flex justify-between items-center shadow-inner">
                            <div className="text-yellow-300 font-mono font-bold text-sm flex items-center">
                                <i className="far fa-clock mr-2 text-white"></i> {formatSimTime(simTime)}
                            </div>
                            <div className="flex gap-1">
                                <button onClick={() => adjustTime(-1, 'D')} className="px-2 py-1 bg-white/10 rounded text-xs hover:bg-white/20">-1D</button>
                                <button onClick={() => adjustTime(-1, 'H')} className="px-2 py-1 bg-white/10 rounded text-xs hover:bg-white/20">-1H</button>
                                <button onClick={() => adjustTime(1, 'H')} className="px-2 py-1 bg-white/10 rounded text-xs hover:bg-white/20">+1H</button>
                                <button onClick={() => adjustTime(1, 'D')} className="px-2 py-1 bg-white/10 rounded text-xs hover:bg-white/20">+1D</button>
                            </div>
                        </div>
                        {view === 'schedule' && (
                            <div className="flex text-sm font-medium pt-1">
                                {['ALL', 'NOW', 'SOON', 'MY AGENDA'].map(tab => (
                                    <button key={tab} onClick={() => setSubTab(tab)} className={`mr-6 pb-3 transition-colors ${subTab === tab ? 'tab-active' : 'tab-inactive'}`}>
                                        {tab}
                                    </button>
                                ))}
                            </div>
                        )}
                    </header>

                    <main className="flex-1 bg-gray-100 p-4">
                        {view === 'schedule' && <ScheduleContent />}
                        {view === 'menu' && <MenuContent />}
                        {view === 'calendar' && <CalendarContent />}
                        {view === 'notes' && <NotesListView />}
                        {view === 'cpd' && (
                            <div className="flex flex-col items-center justify-center h-64 text-gray-400">
                                <i className="fas fa-certificate text-6xl mb-4 text-gray-300"></i>
                                <p>CPD Tracker</p>
                            </div>
                        )}
                    </main>

                    {showNoteModal && (
                        <div className="fixed inset-0 z-[60] modal-backdrop flex items-center justify-center p-4 animate-fade-in" onClick={() => setShowNoteModal(false)}>
                            <div className="bg-white w-full max-w-sm rounded-xl p-5 shadow-2xl transform transition-all" onClick={e => e.stopPropagation()}>
                                <div className="flex justify-between items-center mb-4">
                                    <h3 className="font-bold text-gray-800 text-lg">Personal Note</h3>
                                    <button onClick={() => setShowNoteModal(false)} className="text-gray-400 hover:text-gray-600"><i className="fas fa-times text-xl"></i></button>
                                </div>
                                <div className="mb-4">
                                    <textarea ref={noteInputRef} className="w-full h-40 p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none resize-none text-gray-700 bg-gray-50" placeholder="Type notes here..." value={tempNoteText} onChange={(e) => setTempNoteText(e.target.value)}></textarea>
                                </div>
                                <div className="flex gap-3">
                                    <button onClick={() => setShowNoteModal(false)} className="flex-1 py-2 rounded-lg border border-gray-300 text-gray-600 font-medium hover:bg-gray-50">Cancel</button>
                                    <button onClick={saveNote} className="flex-1 py-2 rounded-lg bg-blue-700 text-white font-medium hover:bg-blue-800 shadow-lg">Save Note</button>
                                </div>
                            </div>
                        </div>
                    )}

                    <nav className="fixed bottom-0 left-0 right-0 bg-white border-t border-gray-200 flex justify-between items-center px-6 h-20 max-w-[480px] mx-auto z-50 bottom-nav-shadow rounded-t-2xl">
                        <button onClick={() => setView('schedule')} className={`flex flex-col items-center justify-center ${view === 'schedule' ? 'text-blue-800' : 'text-gray-400'}`}>
                            <i className="far fa-calendar-check text-xl mb-1"></i><span className="text-[10px] font-medium">Schedule</span>
                        </button>
                        <button onClick={() => setView('calendar')} className={`flex flex-col items-center justify-center ${view === 'calendar' ? 'text-blue-800' : 'text-gray-400'}`}>
                            <i className="far fa-calendar text-xl mb-1"></i><span className="text-[10px] font-medium">Calendar</span>
                        </button>
                        <div className="relative -top-6">
                            <button 
                                onClick={() => setView('notes')}
                                className={`w-14 h-14 rounded-full bg-yellow-400 flex items-center justify-center shadow-lg border-4 border-gray-50 text-blue-900 transform transition-transform active:scale-95 ${view === 'notes' ? 'ring-4 ring-blue-100' : ''}`}
                            >
                                <i className="fas fa-pen-nib text-xl"></i>
                            </button>
                        </div>
                        <button onClick={() => setView('cpd')} className={`flex flex-col items-center justify-center ${view === 'cpd' ? 'text-blue-800' : 'text-gray-400'}`}>
                            <i className="fas fa-ribbon text-xl mb-1"></i><span className="text-[10px] font-medium">CPD</span>
                        </button>
                        <button onClick={() => setView('menu')} className={`flex flex-col items-center justify-center ${view === 'menu' ? 'text-blue-800' : 'text-gray-400'}`}>
                            <i className="fas fa-bars text-xl mb-1"></i><span className="text-[10px] font-medium">Menu</span>
                        </button>
                    </nav>
                </div>
            );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
